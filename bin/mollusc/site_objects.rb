#!/usr/bin/env ruby
# encoding: utf-8
require_relative '../../environment.rb'
include Sinatra::Mimsy::Helpers

skeys = [
  525744,
  525747,
  475560,
  525906,
  525765,
  523855,
  525756,
  525761,
  525758,
  525750,
  525754,
  525749,
  525759,
  525767,
  3497,
  3498,
  3499,
  3500,
  3501,
  3502,
  3503,
  3504,
  3505,
  3506,
  3507,
  3508,
  3509,
  3511,
  3512,
  3514,
  3517,
  3522,
  3568,
  3569,
  3570,
  3571,
  3572,
  3575,
  3574,
  3576,
  3577,
  3578,
  3579,
  3580,
  3581,
  3582,
  3583,
  3584,
  3585,
  3586,
  3587,
  3588,
  3589,
  3590,
  3591,
  3592,
  3593,
  3594,
  3595,
  3596,
  3597,
  3598,
  3599,
  3600,
  3601,
  3603,
  3604,
  3605,
  3606,
  3607,
  3608,
  3609,
  3610,
  3611,
  3612,
  3613,
  3614,
  3615,
  3616,
  3617,
  3618,
  3619,
  3620,
  3622,
  3623,
  3624,
  3625,
  3626,
  3627,
  3628,
  3629,
  3630,
  3631,
  3477,
  3478,
  3479,
  3480,
  3481,
  3482,
  3483,
  3484,
  3485,
  3486,
  3487,
  3488,
  576100,
  3489,
  3490,
  3491,
  3492,
  3493,
  3494,
  3495,
  3496,
  3396,
  3397,
  3398,
  3399,
  3400,
  3401,
  3402,
  3403,
  3404,
  3405,
  575989,
  3406,
  3407,
  3408,
  3409,
  3410,
  3411,
  3412,
  3413,
  3414,
  3415,
  3416,
  3417,
  3418,
  3419,
  3420,
  3421,
  3422,
  3423,
  3424,
  3425,
  3426,
  3427,
  3428,
  3429,
  3430,
  3431,
  3432,
  3433,
  3434,
  3435,
  3436,
  3437,
  3438,
  3439,
  3440,
  3441,
  3442,
  3443,
  3445,
  3446,
  3447,
  3448,
  3449,
  3450,
  3451,
  3452,
  3453,
  3454,
  3455,
  3456,
  3457,
  3458,
  3459,
  3460,
  3461,
  3462,
  3463,
  3464,
  3465,
  3466,
  3467,
  3468,
  3469,
  3470,
  3471,
  3472,
  3473,
  3474,
  3475,
  3476,
  2918,
  2919,
  2920,
  2921,
  2922,
  2923,
  2924,
  2925,
  2979,
  2980,
  2981,
  2982,
  2983,
  2984,
  2985,
  2986,
  3010,
  3011,
  3012,
  3013,
  3014,
  3015,
  3016,
  3017,
  3018,
  3019,
  3020,
  3021,
  3022,
  3023,
  3024,
  3025,
  3026,
  3027,
  3028,
  3029,
  3030,
  3031,
  3032,
  3033,
  3034,
  3035,
  3036,
  2881,
  2882,
  2883,
  2884,
  2885,
  2886,
  2887,
  2888,
  2889,
  2890,
  2891,
  2892,
  2893,
  2894,
  2895,
  2896,
  2897,
  2898,
  2899,
  2900,
  2901,
  2902,
  2903,
  2904,
  2905,
  2906,
  2907,
  2908,
  2909,
  2910,
  2911,
  2912,
  2913,
  2914,
  2915,
  2916,
  2917,
  3052,
  3053,
  3054,
  3055,
  3059,
  3060,
  3062,
  3065,
  3067,
  3070,
  3072,
  3077,
  3078,
  3079,
  3080,
  3081,
  3082,
  3083,
  3084,
  3085,
  3086,
  3087,
  3089,
  3092,
  3094,
  3096,
  3103,
  3104,
  3107,
  3111,
  3113,
  753,
  754,
  755,
  756,
  757,
  758,
  759,
  760,
  762,
  763,
  764,
  766,
  767,
  768,
  769,
  770,
  771,
  772,
  774,
  776,
  777,
  741,
  742,
  743,
  744,
  745,
  746,
  747,
  748,
  749,
  750,
  751,
  752,
  812,
  811,
  810,
  809,
  808,
  807,
  805,
  806,
  783,
  784,
  785,
  786,
  787,
  788,
  789,
  790,
  791,
  792,
  793,
  794,
  795,
  796,
  798,
  797,
  799,
  800,
  801,
  802,
  803,
  804,
  11527,
  555177,
  555178,
  555179,
  555180,
  678,
  679,
  680,
  681,
  682,
  683,
  684,
  685,
  686,
  687,
  727,
  728,
  729,
  730,
  731,
  732,
  733,
  734,
  735,
  736,
  737,
  738,
  739,
  740,
  779,
  780,
  781,
  782,
  688,
  689,
  691,
  692,
  695,
  696,
  698,
  699,
  700,
  701,
  703,
  705,
  710,
  713,
  715,
  717,
  718,
  721,
  722,
  723,
  724,
  725,
  726,
  547,
  551,
  562,
  568,
  567,
  563,
  565,
  566,
  561,
  571,
  572,
  549,
  556,
  550,
  557,
  553,
  554,
  569,
  581,
  583,
  573,
  548,
  163,
  540,
  574,
  552,
  541,
  542,
  546,
  575,
  543,
  544,
  545,
  162,
  580,
  560,
  555,
  582,
  576,
  475805,
  578,
  591,
  579,
  538,
  539,
  537,
  536,
  592,
  558,
  559,
  585,
  372628,
  584,
  588,
  587,
  161,
  570,
  589,
  590,
  577,
  586,
  411683,
  411684,
  12949,
  411685,
  14241,
  411686,
  11524,
  361,
  362,
  363,
  364,
  365,
  471,
  414,
  413,
  415,
  407,
  488579,
  416,
  408,
  419,
  410,
  412,
  409,
  411,
  417,
  418,
  406,
  404,
  405,
  420,
  551519,
  422,
  421,
  425,
  424,
  427,
  426,
  428,
  430,
  429,
  463,
  462,
  384,
  383,
  381,
  382,
  385,
  386,
  387,
  388,
  389,
  397,
  398,
  396,
  395,
  394,
  393,
  392,
  391,
  390,
  366,
  402,
  403,
  399,
  400,
  367,
  368,
  371,
  372,
  370,
  369,
  373,
  374,
  376,
  377,
  375,
  378,
  379,
  380,
  404656,
  15664,
  15478,
  488570,
  14969,
  201,
  197,
  199,
  200,
  196,
  198,
  195,
  202,
  189,
  188,
  207,
  187,
  208,
  186,
  185,
  192,
  176,
  179,
  177,
  205,
  16176,
  204,
  484600,
  184,
  203,
  183,
  206,
  180,
  193,
  191,
  190,
  181,
  182,
  173,
  174,
  164,
  1078,
  1079,
  1080,
  1081,
  169,
  175,
  165,
  1082,
  166,
  167,
  168,
  1083,
  171,
  170,
  172,
  992,
  993,
  1026,
  1027,
  1028,
  1030,
  1031,
  1032,
  1033,
  1034,
  1035,
  1036,
  1037,
  1038,
  1039,
  1040,
  1085,
  1086,
  1087,
  1088,
  2,
  1090,
  1093,
  1094,
  1095,
  1096,
  5,
  6,
  1097,
  7,
  1098,
  1099,
  1100,
  8,
  3,
  4,
  813,
  845,
  846,
  847,
  849,
  848,
  850,
  14,
  880,
  881,
  882,
  883,
  884,
  885,
  73,
  74,
  141,
  75,
  76,
  77,
  78,
  79,
  80,
  81,
  82,
  83,
  84,
  85,
  86,
  87,
  89,
  90,
  91,
  92,
  93,
  94,
  96,
  97,
  98,
  886,
  891,
  99,
  100,
  101,
  892,
  893,
  102,
  103,
  104,
  894,
  105,
  106,
  895,
  107,
  143,
  108,
  896,
  897,
  898,
  899,
  900,
  901,
  15,
  902,
  903,
  904,
  905,
  906,
  924,
  925,
  926,
  927,
  928,
  16,
  17,
  455852,
  929,
  930,
  931,
  932,
  933,
  934,
  18,
  935,
  951,
  952,
  953,
  109,
  110,
  455811,
  19,
  20,
  21,
  22,
  23,
  24,
  25,
  26,
  27,
  28,
  29,
  30,
  31,
  9,
  32,
  33,
  34,
  844,
  35,
  36,
  37,
  38,
  39,
  40,
  41,
  42,
  43,
  44,
  851,
  852,
  45,
  853,
  854,
  855,
  10,
  856,
  857,
  46,
  47,
  48,
  49,
  50,
  51,
  858,
  11,
  12,
  52,
  53,
  54,
  55,
  56,
  57,
  58,
  859,
  860,
  59,
  861,
  862,
  863,
  864,
  60,
  865,
  111,
  112,
  61,
  62,
  63,
  64,
  65,
  66,
  866,
  867,
  868,
  113,
  869,
  870,
  871,
  872,
  873,
  67,
  68,
  69,
  875,
  876,
  13,
  877,
  70,
  71,
  878,
  72,
  879,
  142,
  994,
  995,
  996,
  997,
  998,
  999,
  1000,
  1001,
  1002,
  1003,
  1004,
  1005,
  1010,
  1025,
  1012,
  1014,
  1017,
  1016,
  1015,
  1018,
  1019,
  1020,
  1021,
  1022,
  1023,
  1024,
  1042,
  1043,
  1044,
  1045,
  1046,
  1048,
  1049,
  1050,
  1051,
  1053,
  1055,
  1057,
  1058,
  1059,
  1060,
  1061,
  1062,
  475408,
  436745,
  435148,
  1101,
  1102,
  1103,
  1104,
  1105,
  1106,
  1133,
  1107,
  1108,
  1109,
  1110,
  1111,
  1112,
  1113,
  1115,
  1116,
  1134,
  1135,
  1117,
  1118,
  1119,
  1120,
  1121,
  1122,
  1123,
  1124,
  1125,
  1126,
  1127,
  1128,
  1129,
  1130,
  1131,
  1132,
  1063,
  1064,
  1065,
  1066,
  1067,
  1068,
  1069,
  1070,
  1071,
  1072,
  1073,
  1074,
  1075,
  1076,
  1077,
  954,
  956,
  958,
  960,
  963,
  965,
  966,
  967,
  968,
  969,
  972,
  973,
  974,
  975,
  982,
  983,
  984,
  985,
  986,
  987,
  988,
  989,
  990,
]

pbar = ProgressBar.create(title: "Site-Objects", total: skeys.size, autofinish: false, format: '%t %b>> %i| %e')

CSV.open(output_dir(__FILE__) + "/site-objects.csv", 'w') do |csv|
  skeys.each do |skey|
    pbar.increment
    site = Site.find(skey)
    catalogs = site.catalogs.map(&:catalog_number).join("; ")
    csv << [skey, catalogs]
  end
end

pbar.finish
